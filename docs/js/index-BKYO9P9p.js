import{d as w,o as _,c as C,a as t,t as x,b as f,u,I as ae,e as F,r as A,f as ne,h as se,g as V,i as D,s as oe,j as ie,k as ce,l as I,m as re,n as Y,w as b,B as M,p as O,P as le,q as U,v as q,x as Z,R as W,y as J,z as de,F as ue,A as me,C as pe}from"./vendor-CTBqkF5L.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))c(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const p of s.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&c(p)}).observe(document,{childList:!0,subtree:!0});function a(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function c(n){if(n.ep)return;n.ep=!0;const s=a(n);fetch(n.href,s)}})();const ve={class:"base-panel"},ge={class:"base-panel-header"},fe={class:"base-panel-header-title"},_e={key:0,class:"base-panel-header-tip"},ye={style:{"margin-left":"2px"}},he={key:0,class:"base-panel-filter"},be={style:{display:"flex","grid-gap":"10px"}},$e={class:"base-panel-body"},Ce={class:"base-panel-wrap"},ke=w({__name:"BasePanel",props:{title:{},tip:{}},setup(o){return(e,a)=>(_(),C("div",ve,[t("div",ge,[t("div",null,[t("span",fe,x(e.title),1),e.tip?(_(),C("span",_e,[f(u(ae)),t("span",ye,x(e.tip),1)])):F("",!0)])]),e.$slots.filter?(_(),C("div",he,[A(e.$slots,"filter",{},void 0,!0),t("div",be,[A(e.$slots,"extra",{},void 0,!0)])])):F("",!0),t("div",$e,[t("div",Ce,[A(e.$slots,"body",{},void 0,!0)])])]))}}),L=(o,e)=>{const a=o.__vccOpts||o;for(const[c,n]of e)a[c]=n;return a},X=L(ke,[["__scopeId","data-v-cac63176"]]);function we(o){return new Promise((e,a)=>{const c=new Image;c.onload=()=>e({width:c.width,height:c.height}),c.src=o})}function Se(o,e){const a=w({render(){return se(o,e)}}),c=f(a);return ne(c,document.createElement("div")),c.el}function d(o){return`./${o}`}function Ie(o){const{devices:e,deviceSorts:a,currentDevices:c,currentDeviceSort:n}=xe(),s=V([{label:"场景1",value:"场景1",image:d("/images/scenes/1.png"),devices:[]},{label:"场景2",value:"场景2",image:d("/images/scenes/2.png"),devices:[]}]),p=D(s[0].value),r=oe(),$=D(!1),R=()=>{r.value=I.map(o.planeContainer.value,{minZoom:1,maxZoom:4,crs:I.CRS.Simple,attributionControl:!1})},P=()=>{const l=o.deviceContainer.value,v=o.planeContainer.value;l.ondragstart=i=>{const m=i.target.getAttribute("data-code");i.dataTransfer.setData("data-code",m)},v.ondragover=i=>i.preventDefault(),v.ondrop=i=>{const g=i.dataTransfer.getData("data-code"),m=e.find(j=>j.code===g);s.find(j=>j.value===p.value).devices.push(m);const S=r.value.getBounds(),h=S.getNorth(),Q=S.getWest(),z=r.value.getZoom(),N=r.value.project([h,Q],z),T=v.getBoundingClientRect(),ee=i.clientX-T.left,te=i.clientY-T.top,G=r.value.unproject([ee+N.x,te+N.y],z);m.position=G,k(m,G)}},B=async()=>{$.value=!0,r.value.eachLayer(h=>{r.value.removeLayer(h)});const l=s.find(h=>h.value===p.value),{width:v,height:i}=await we(l.image),g=r.value.getMinZoom()+1,m=r.value.unproject([0,i],g),E=r.value.unproject([v,0],g),S=new I.LatLngBounds(m,E);I.imageOverlay(l.image,S).addTo(r.value),r.value.fitBounds(S),$.value=!1,l.devices.forEach(h=>{h.position&&k(h,h.position)})},y=l=>{const v=s.find(i=>i.value===p.value);v.devices=v.devices.filter(i=>i.code!==l),r.value.eachLayer(i=>{i instanceof I.Marker&&i.options.title===l&&r.value.removeLayer(i)}),Array.from(document.querySelectorAll(".arco-trigger-popup")).map(i=>{document.body.removeChild(i)})},k=(l,v)=>{const i=Se(Ge,{data:l,onRemove:y}),g=I.divIcon({html:i,iconSize:[2,2],iconAnchor:[1,1]}),m=I.marker(v,{icon:g,draggable:!0});m.options.title=l.code,m.on("mouseover",()=>{m.getElement().style.zIndex="1000"}),m.on("mouseout",()=>{m.getElement().style.zIndex="256"}),m.on("moveend",()=>{l.position=m.getLatLng()}),m.addTo(r.value)},H=()=>{const l=JSON.stringify(s,null,2),v=new Blob([l],{type:"application/json"}),i=URL.createObjectURL(v),g=document.createElement("a");g.href=i,g.download="scenes.json",g.click()},K=()=>{const l=document.createElement("input");l.type="file",l.accept=".json",l.onchange=async()=>{const v=l.files[0],i=new FileReader;i.onload=g=>{const m=g.target.result,E=JSON.parse(m);s.length=0,E.forEach((S,h)=>{s[h]=S}),p.value=s[0].value,B()},i.readAsText(v)},l.click()};return ie(()=>{R(),P(),B()}),{devices:e,deviceSorts:a,scenes:s,currentDevices:c,currentDeviceSort:n,currentScene:p,onSceneChange:B,onRemoveDevice:y,onExportScenes:H,onImportScenes:K}}function xe(){const o=V([{name:"空气加湿器",code:"b64d86a19dc7",image:d("/images/devices/1.png"),category:"其他"},{name:"轻薄笔记本",code:"k52b8717d009",image:d("/images/devices/1.png"),category:"娱乐"},{name:"智慧吸顶灯",code:"c8317a6a586f",image:d("/images/devices/3.png"),category:"其他"},{name:"云台摄像头",code:"cf3be09a9e47",image:d("/images/devices/4.png"),category:"安全"},{name:"空气净化器",code:"qaa2d9c17cda",image:d("/images/devices/5.png"),category:"温控"},{name:"滚筒洗衣机",code:"f792dd8f989f",image:d("/images/devices/6.png"),category:"其他"},{name:"按摩椅",code:"1ccefe2be178",image:d("/images/devices/7.png"),category:"娱乐"},{name:"投影仪",code:"b1c9ff86591a",image:d("/images/devices/8.png"),category:"娱乐"},{name:"电吹风",code:"ad77e73280d3",image:d("/images/devices/9.png"),category:"其他"},{name:"温度传感器",code:"d500b354a7fd",image:d("/images/devices/10.png"),category:"温控"},{name:"扫地机器人",code:"f32638d152b8",image:d("/images/devices/11.png"),category:"安全"},{name:"智能音箱",code:"w5ea0618149d",image:d("/images/devices/12.png"),category:"娱乐"},{name:"智能闹钟",code:"c3e3f3a6213d",image:d("/images/devices/13.png"),category:"其他"},{name:"智能门锁",code:"ccc5e7d2c7da",image:d("/images/devices/14.png"),category:"安全"},{name:"打印机",code:"eeb5772561a6",image:d("/images/devices/15.png"),category:"其他"},{name:"电风扇",code:"cc805117dc5d",image:d("/images/devices/16.png"),category:"其他"},{name:"冰柜",code:"e801626f006b",image:d("/images/devices/17.png"),category:"温控"}]),e=V(["其他","娱乐","安全","温控"]),a=D(e[0]),c=ce(()=>re.filter(o,{category:a.value}));return{devices:o,deviceSorts:e,currentDevices:c,currentDeviceSort:a}}const De={class:"base-device-item",draggable:"true"},Le={class:"base-device-item-name"},Be={class:"base-device-item-code"},Ee=w({__name:"BaseDeviceItem",props:{data:{}},setup(o){return(e,a)=>(_(),C("div",De,[t("div",{class:"base-device-item-image",style:Y({backgroundImage:`url(${e.data.image})`})},null,4),t("div",null,[t("div",Le,x(e.data.name),1),t("div",Be,x(e.data.code),1)])]))}}),Ae=L(Ee,[["__scopeId","data-v-40a09a59"]]),Re={class:"base-device-detail"},Pe=["src"],je={class:"base-device-detail-name"},Ve={class:"base-device-detail-items"},Me={class:"detail-item"},Oe={class:"item-value"},ze=w({__name:"BaseDeviceDetail",props:{data:{}},setup(o){return(e,a)=>(_(),C("div",Re,[t("img",{class:"base-device-detail-banner",src:e.data.image,alt:""},null,8,Pe),t("div",je,x(e.data.name),1),t("div",Ve,[a[1]||(a[1]=t("div",{class:"detail-item"},[t("div",{class:"item-label"},"品牌"),t("div",{class:"item-value"},"小米公司")],-1)),t("div",Me,[a[0]||(a[0]=t("div",{class:"item-label"},"分类",-1)),t("div",Oe,x(e.data.category),1)]),a[2]||(a[2]=t("div",{class:"detail-item"},[t("div",{class:"item-label"},"状态"),t("div",{class:"item-value"},"在线")],-1))])]))}}),Ne=L(ze,[["__scopeId","data-v-5602bfa5"]]),Te={class:"base-device-marker"},Ge=w({__name:"BaseDeviceMarker",props:{data:{},onRemove:{type:Function}},setup(o){return(e,a)=>(_(),C("div",Te,[f(u(le),{position:"rt",trigger:"contextMenu"},{content:b(()=>[f(Ne,{data:e.data},null,8,["data"]),f(u(M),{size:"mini",long:"",type:"primary",status:"danger",onClick:a[0]||(a[0]=()=>e.onRemove(e.data.code))},{default:b(()=>a[1]||(a[1]=[O(" 移除 ")])),_:1})]),default:b(()=>[t("div",{class:"base-device-marker-image",style:Y({backgroundImage:`url(${e.data.image})`})},null,4)]),_:1}),a[2]||(a[2]=t("div",{class:"base-device-marker-dot"},null,-1))]))}}),Fe={},Ue={class:"layout-brand"};function qe(o,e){return _(),C("div",Ue,e[0]||(e[0]=[t("div",{class:"layout-brand-logo"},null,-1),t("div",{class:"layout-brand-title"},"Plane-Graph",-1)]))}const Ze=L(Fe,[["render",qe],["__scopeId","data-v-7756826b"]]),We={class:"layout-actions"},Je={class:"mf-icon mf-icon-moon"},Xe={class:"mf-icon mf-icon-sun"},Ye=w({__name:"LayoutActions",setup(o){const e=D(!1),a={onTheme(c){const n=c.clientX,s=c.clientY,p=Math.hypot(Math.max(n,innerWidth-n),Math.max(s,innerHeight-s));e.value=!e.value,document.startViewTransition(()=>{const $=document.documentElement;$.classList.remove(e.value?"dark":"light"),$.classList.add(e.value?"light":"dark"),document.body.setAttribute("arco-theme",e.value?"dark":"light")}).ready.then(()=>{const $=[`circle(0px at ${n}px ${s}px)`,`circle(${p}px at ${n}px ${s}px)`];document.documentElement.animate({clipPath:e.value?[...$].reverse():[...$]},{duration:500,easing:"ease-in",pseudoElement:e.value?"::view-transition-old(root)":"::view-transition-new(root)"})})},onGithub(){window.open("https://github.com/fengtianxi001","_blank")}};return(c,n)=>(_(),C("div",We,[t("div",{class:"action-item",onClick:n[0]||(n[0]=(...s)=>a.onTheme&&a.onTheme(...s))},[U(t("i",Je,null,512),[[q,!e.value]]),U(t("i",Xe,null,512),[[q,e.value]])]),t("div",{class:"action-item",onClick:n[1]||(n[1]=(...s)=>a.onGithub&&a.onGithub(...s))},n[2]||(n[2]=[t("i",{class:"mf-icon mf-icon-github"},null,-1)]))]))}}),He=L(Ye,[["__scopeId","data-v-651d3203"]]),Ke={class:"layout"},Qe={class:"layout-header"},et={style:{display:"flex"}},tt={style:{display:"flex"}},at={class:"layout-body"},nt=w({__name:"Layout",setup(o){return(e,a)=>(_(),C("div",Ke,[t("div",Qe,[t("div",et,[f(Ze)]),t("div",tt,[f(He)])]),t("div",at,[A(e.$slots,"default")])]))}}),st=w({__name:"App",setup(o){const e=D(null),a=D(null),{deviceSorts:c,scenes:n,currentDevices:s,currentDeviceSort:p,currentScene:r,onSceneChange:$,onExportScenes:R,onImportScenes:P}=Ie({planeContainer:e,deviceContainer:a});return(B,y)=>(_(),Z(u(nt),null,{default:b(()=>[f(u(X),{title:"房间平面图",tip:"右击图标查看设备详情"},{extra:b(()=>[f(u(M),{type:"primary",size:"small",onClick:u(R)},{default:b(()=>y[2]||(y[2]=[O(" 导出场景 ")])),_:1},8,["onClick"]),f(u(M),{type:"primary",size:"small",onClick:u(P)},{default:b(()=>y[3]||(y[3]=[O(" 导入场景 ")])),_:1},8,["onClick"])]),filter:b(()=>[f(u(W),{modelValue:u(r),"onUpdate:modelValue":y[0]||(y[0]=k=>J(r)?r.value=k:null),options:u(n),type:"button",onChange:u($)},null,8,["modelValue","options","onChange"])]),body:b(()=>[t("div",{class:"plane-container",ref_key:"planeContainer",ref:e},null,512)]),_:1}),f(u(X),{title:"智能设备",tip:"拖拽设备至左侧进行放置"},{filter:b(()=>[f(u(W),{modelValue:u(p),"onUpdate:modelValue":y[1]||(y[1]=k=>J(p)?p.value=k:null),options:u(c),type:"button"},null,8,["modelValue","options"])]),body:b(()=>[t("div",{class:"device-container",ref_key:"deviceContainer",ref:a},[(_(!0),C(ue,null,de(u(s),k=>(_(),Z(u(Ae),{"data-code":k.code,data:k},null,8,["data-code","data"]))),256))],512)]),_:1})]),_:1}))}}),ot=L(st,[["__scopeId","data-v-14f1331b"]]),it=async()=>{const o=me(ot);o.use(pe),o.mount("#app")};it();
